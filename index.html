<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MyGP ‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡ßá ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <link href="https://fonts.maateen.me/solaiman-lipi/font.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
    <style>
        :root {
            --primary-color: #00b0f0;
            --gp-blue: #00b0f0;
            --bcl-green: #00a651;
            --secondary-color: #ff6b35;
            --dark-color: #2c3e50;
            --light-bg: #f8f9fa;
            --gradient: linear-gradient(135deg, #00b0f0 0%, #0088cc 100%);
            --bcl-gradient: linear-gradient(135deg, #00a651 0%, #00b0f0 100%);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'SolaimanLipi', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #ffffff;
            min-height: 100vh;
            padding: 20px 0;
        }

        .main-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 15px;
        }

        .glass-card {
            background: #ffffff;
            border: 1px solid #e0e0e0;
            border-radius: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            padding: 30px;
            margin-bottom: 30px;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        @media (min-width: 769px) {
            .glass-card:hover {
                transform: translateY(-5px);
                box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15);
            }
        }

        .header-section {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px;
            background: linear-gradient(135deg, #b0f3d1 0%, #d5f4ff 100%);
            border-radius: 20px;
            color: rgb(0, 0, 0);
            font-weight: bold;
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .header-logo-left {
            width: 150px;
            height: auto;
            flex-shrink: 0;
        }

        .header-logo-right {
            width: 80px;
            height: auto;
            flex-shrink: 0;
        }

        .header-content {
            flex: 1;
            padding: 0 20px;
        }

        .header-section::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: pulse 4s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 0.5; }
            50% { transform: scale(1.1); opacity: 0.8; }
        }

        .nav-tabs {
            border-bottom: 3px solid #e0e0e0;
            /* margin-bottom: 30px; */
            background: white;
            padding: 10px 10px 0;
        }

        .nav-tabs .nav-link {
            color: #333;
            background: #f5f5f5;
            font-weight: 600;
            padding: 12px 25px;
            border: none;
            border-radius: 10px 10px 0 0;
            margin-right: 5px;
            transition: all 0.3s ease;
        }

        .nav-tabs .nav-link.active {
            background: linear-gradient(135deg, #00b0f0 0%, #0088cc 100%);
            color: white;
            border: none;
        }

        .nav-tabs .nav-link:hover {
            background: rgba(0, 176, 240, 0.2);
            transform: translateY(-2px);
            color: #00b0f0;
        }

        .form-control, .form-select {
            border-radius: 10px;
            border: 2px solid #e0e0e0;
            padding: 12px 15px;
            transition: all 0.3s ease;
        }

        .form-control:focus, .form-select:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 0.2rem rgba(0, 176, 240, 0.25);
        }

        /* Radio Button Style */
        .radio-button-group {
            display: flex;
            gap: 15px;
        }

        .radio-button-group input[type="radio"] {
            display: none;
        }

        .radio-button-group label {
            flex: 1;
            padding: 12px 20px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            background: white;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .radio-button-group label::before {
            content: '‚úì';
            font-size: 1.3rem;
            font-weight: bold;
            opacity: 0;
            transition: opacity 0.3s ease;
            margin-right: -5px;
        }

        .radio-button-group input[type="radio"]:checked + label {
            background: var(--gradient);
            color: white;
            border-color: var(--primary-color);
            box-shadow: 0 4px 12px rgba(0, 176, 240, 0.3);
        }

        .radio-button-group input[type="radio"]:checked + label::before {
            opacity: 1;
        }

        .radio-button-group label:hover {
            border-color: var(--primary-color);
            background: rgba(0, 176, 240, 0.05);
            transform: translateY(-2px);
        }

        .radio-button-group input[type="radio"]:checked + label:hover {
            background: linear-gradient(135deg, #00b0f0 0%, #0088cc 100%);
        }

        .btn-primary {
            background: linear-gradient(135deg, #00b0f0 0%, #0088cc 100%);
            border: none;
            border-radius: 10px;
            padding: 12px 30px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0, 176, 240, 0.3);
            background: linear-gradient(135deg, #0088cc 0%, #006699 100%);
        }

        .stat-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            border-left: 5px solid var(--gp-blue);
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.15);
        }

        .stat-card-icon {
            flex-shrink: 0;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 12px;
            background: linear-gradient(135deg, rgba(0, 176, 240, 0.1) 0%, rgba(0, 136, 204, 0.1) 100%);
        }

        .stat-card-content {
            flex: 1;
            text-align: left;
        }

        .stat-card-content small {
            display: block;
            color: #6c757d;
            font-weight: 600;
            margin-top: 3px;
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: bold;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            line-height: 1;
            margin-bottom: 5px;
        }

        .stat-card p {
            margin: 0;
        }

        .profession-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        @media (min-width: 769px) {
            .profession-card:hover {
                transform: translateX(10px);
                box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
            }
        }

        .profession-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .progress {
            height: 25px;
            border-radius: 15px;
            background: #f0f0f0;
            overflow: visible;
        }

        .progress-bar {
            border-radius: 15px;
            background: var(--gradient);
            position: relative;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .reason-badge {
            display: inline-block;
            padding: 8px 15px;
            border-radius: 20px;
            margin: 5px;
            font-weight: 600;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .chart-container {
            position: relative;
            height: 300px;
            margin: 20px 0;
        }

        .floating-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--gradient);
            color: white;
            border: none;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            font-size: 1.5rem;
            z-index: 1000;
            transition: all 0.3s ease;
        }

        .floating-btn:hover {
            transform: scale(1.1) rotate(90deg);
        }

        .toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 2000;
        }

        .custom-toast {
            background: white;
            border-radius: 10px;
            padding: 15px 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            margin-bottom: 10px;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .profession-header {
            background: var(--gradient);
            color: white;
            padding: 20px;
            border-radius: 15px 15px 0 0;
            margin: -20px -20px 20px -20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .profession-header h4 {
            margin: 0;
        }

        .view-report-icon {
            font-size: 1.5rem;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .view-report-icon:hover {
            transform: scale(1.2);
        }

        .percentage-circle {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: conic-gradient(var(--gp-blue) 0deg, var(--bcl-green) 120deg, #ffd93d 240deg, #6bcf7f 360deg);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 20px auto;
            position: relative;
        }

        .percentage-circle::before {
            content: '';
            position: absolute;
            width: 90px;
            height: 90px;
            background: white;
            border-radius: 50%;
        }

        .percentage-text {
            position: relative;
            z-index: 1;
            font-weight: bold;
            font-size: 1.2rem;
        }

        #allEntriesTable thead th {
            position: sticky;
            top: 0;
            z-index: 10;
        }

        #allEntriesTable tbody tr:hover {
            background-color: rgba(0, 176, 240, 0.1);
            cursor: pointer;
        }

            @media (max-width: 768px) {
            .stat-card {
                margin-bottom: 15px;
                padding: 15px;
                gap: 15px;
            }

            .stat-card-icon {
                width: 50px;
                height: 50px;
            }

            .stat-card-icon i {
                font-size: 1.5rem !important;
            }

            .stat-number {
                font-size: 2rem !important;
            }

            .stat-card-content p {
                font-size: 0.75rem !important;
            }

            .stat-card-content small {
                font-size: 0.7rem !important;
            }
            
            .header-section {
                flex-direction: row;
                flex-wrap: wrap;
                padding: 15px 10px;
                margin-bottom: 20px;
                gap: 10px;
            }

            .header-logo-left {
                width: 80px;
                margin-bottom: 0;
            }

            .header-logo-right {
                width: 50px;
                margin-bottom: 0;
            }

            .header-content {
                flex: 1;
                min-width: 100%;
                padding: 10px 0 0;
                order: 3;
            }

            .header-content h1 {
                font-size: 1.3rem;
                margin-bottom: 5px;
            }

            .header-content .lead {
                font-size: 0.85rem;
            }
            
            .glass-card {
                padding: 15px;
            }

            .nav-tabs {
                padding: 5px;
                overflow-x: auto;
                white-space: nowrap;
                -webkit-overflow-scrolling: touch;
            }

            .nav-tabs .nav-link {
                font-size: 0.85rem;
                padding: 10px 15px;
                display: inline-block;
            }

            .profession-card {
                padding: 15px;
            }

            .profession-header {
                flex-direction: row;
                padding: 15px;
            }

            .profession-header h4 {
                font-size: 1.1rem;
            }

            .percentage-circle {
                width: 80px;
                height: 80px;
            }

            .percentage-circle::before {
                width: 60px;
                height: 60px;
            }

            .percentage-text {
                font-size: 1rem;
            }

            .floating-btn {
                width: 50px;
                height: 50px;
                bottom: 20px;
                right: 20px;
                font-size: 1.2rem;
            }

            .main-container {
                padding: 0 10px;
            }

            body {
                padding: 10px 0;
            }

            .radio-button-group {
                flex-direction: row;
                gap: 10px;
            }

            .radio-button-group label {
                padding: 10px 15px;
                font-size: 0.95rem;
            }

            .table-responsive {
                font-size: 0.85rem;
            }

            .table th, .table td {
                padding: 8px;
            }

            .stat-card-content small {
                font-size: 0.7rem !important;
            }

            .stat-card-content p {
                font-size: 0.75rem !important;
            }

            .chart-container {
                height: 250px;
            }

            .modal-dialog {
                margin: 10px;
            }

            .table {
                font-size: 0.85rem;
            }

            .form-label {
                font-size: 0.9rem;
            }

            .form-control, .form-select {
                font-size: 0.9rem;
                padding: 10px;
            }

            .btn-primary {
                padding: 10px 20px;
                font-size: 0.9rem;
            }
        }

        .footer {
            text-align: center;
            padding: 30px 0;
            margin-top: 40px;
            background: #f8f9fa;
            border-radius: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            border: 1px solid #e0e0e0;
        }

        .footer a {
            color: #00b0f0;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .footer a:hover {
            color: #0088cc;
            text-decoration: underline;
        }

        /* Loader Styles */
        .loader-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            backdrop-filter: blur(5px);
        }

        .loader-overlay.show {
            display: flex;
        }

        .loader-content {
            background: white;
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .spinner {
            width: 60px;
            height: 60px;
            margin: 0 auto 20px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid #00b0f0;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loader-text {
            font-size: 1.2rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 10px;
        }

        .loader-subtext {
            color: #666;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <div class="main-container">
        <!-- Header Section -->
        <div class="header-section">
            <img src="assets/bclgroup-lgoo.png" alt="BCL Group" class="header-logo-left">
            <div class="header-content">
                <h1 class="mb-2"><i class="bi bi-clipboard-data"></i> MyGP ‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡ßá ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™‡ßç‡¶≤‡¶ø‡¶ï‡ßá‡¶∂‡¶®</h1>
                <p class="lead mb-0">‡¶™‡ßá‡¶∂‡¶æ‡¶≠‡¶ø‡¶§‡ßç‡¶§‡¶ø‡¶ï MyGP ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡ßá ‡¶è‡¶¨‡¶Ç ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü‡¶ø‡¶Ç ‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ</p>
            </div>
            <img src="assets/Grameenphone_Logo.png" alt="Grameenphone" class="header-logo-right">
        </div>

        <!-- Navigation Tabs -->
        <ul class="nav nav-tabs" id="mainTabs" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="survey-tab" data-bs-toggle="tab" data-bs-target="#survey" type="button">
                    <i class="bi bi-clipboard-plus"></i> ‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡ßá ‡¶´‡¶∞‡ßç‡¶Æ
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="dashboard-tab" data-bs-toggle="tab" data-bs-target="#dashboard" type="button">
                    <i class="bi bi-speedometer2"></i> ‡¶°‡ßç‡¶Ø‡¶æ‡¶∂‡¶¨‡ßã‡¶∞‡ßç‡¶°
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="reports-tab" data-bs-toggle="tab" data-bs-target="#reports" type="button">
                    <i class="bi bi-graph-up"></i>  ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü
                </button>
            </li>
        </ul>

        <!-- Tab Content -->
        <div class="tab-content" id="mainTabContent">
            <!-- Survey Form Tab -->
            <div class="tab-pane fade show active" id="survey" role="tabpanel">
                <div class="glass-card">
                    <h3 class="mb-4"><i class="bi bi-person-plus-fill"></i> ‡¶®‡¶§‡ßÅ‡¶® ‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡ßá ‡¶§‡¶•‡ßç‡¶Ø ‡¶™‡ßç‡¶∞‡¶¶‡¶æ‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</h3>
                    <form id="surveyForm">
                        <!-- Personal Information Row -->
                        <div class="row">
                            <div class="col-md-4 mb-3">
                                <label for="name" class="form-label">
                                    <i class="bi bi-person-fill"></i> ‡¶®‡¶æ‡¶Æ
                                </label>
                                <input type="text" class="form-control" id="name" placeholder="‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®" required>
                            </div>
                            <div class="col-md-4 mb-3">
                                <label for="phoneNumber" class="form-label">
                                    <i class="bi bi-telephone"></i> ‡¶´‡ßã‡¶® ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞
                                </label>
                                <input type="tel" class="form-control" id="phoneNumber" placeholder="01XXXXXXXXX" required>
                            </div>
                            <div class="col-md-4 mb-3">
                                <label for="profession" class="form-label">
                                    <i class="bi bi-briefcase"></i> ‡¶™‡ßá‡¶∂‡¶æ
                                </label>
                                <select class="form-select" id="profession" required>
                                    <option value="">‡¶™‡ßá‡¶∂‡¶æ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</option>
                                    <option value="‡¶°‡¶æ‡¶ï‡ßç‡¶§‡¶æ‡¶∞">‡¶°‡¶æ‡¶ï‡ßç‡¶§‡¶æ‡¶∞</option>
                                    <option value="‡¶á‡¶û‡ßç‡¶ú‡¶ø‡¶®‡¶ø‡¶Ø‡¶º‡¶æ‡¶∞">‡¶á‡¶û‡ßç‡¶ú‡¶ø‡¶®‡¶ø‡¶Ø‡¶º‡¶æ‡¶∞</option>
                                    <option value="‡¶õ‡¶æ‡¶§‡ßç‡¶∞">‡¶õ‡¶æ‡¶§‡ßç‡¶∞</option>
                                    <option value="‡¶ö‡¶æ‡¶ï‡ßÅ‡¶∞‡¶ø‡¶ú‡ßÄ‡¶¨‡¶ø">‡¶ö‡¶æ‡¶ï‡ßÅ‡¶∞‡¶ø‡¶ú‡ßÄ‡¶¨‡¶ø</option>
                                    <option value="‡¶¨‡ßç‡¶Ø‡¶¨‡¶∏‡¶æ‡¶Ø‡¶º‡ßÄ">‡¶¨‡ßç‡¶Ø‡¶¨‡¶∏‡¶æ‡¶Ø‡¶º‡ßÄ</option>
                                    <option value="‡¶™‡¶•‡¶ö‡¶æ‡¶∞‡ßÄ">‡¶™‡¶•‡¶ö‡¶æ‡¶∞‡ßÄ</option>
                                </select>
                            </div>
                        </div>
                        <!-- MyGP Information Row -->
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">
                                    <i class="bi bi-phone"></i> MyGP ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™ ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßá‡¶® ‡¶ï‡¶ø‡¶®‡¶æ?
                                </label>
                                <div class="radio-button-group">
                                    <input type="radio" name="useMyGP" id="useYes" value="yes" required>
                                    <label for="useYes">‡¶π‡ßç‡¶Ø‡¶æ‡¶Å</label>
                                    <input type="radio" name="useMyGP" id="useNo" value="no" required>
                                    <label for="useNo">‡¶®‡¶æ</label>
                                </div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="reason" class="form-label">
                                    <i class="bi bi-question-circle"></i> ‡¶ï‡ßá‡¶® ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßá‡¶®?
                                </label>
                                <select class="form-select" id="reason" disabled>
                                    <option value="">‡¶ï‡¶æ‡¶∞‡¶£ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</option>
                                    <option value="‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü/‡¶°‡¶æ‡¶ü‡¶æ ‡¶¶‡ßá‡¶ñ‡¶æ ‡¶¨‡¶æ ‡¶ï‡ßç‡¶∞‡ßü ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø">‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü/‡¶°‡¶æ‡¶ü‡¶æ ‡¶¶‡ßá‡¶ñ‡¶æ ‡¶¨‡¶æ ‡¶ï‡ßç‡¶∞‡ßü ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø</option> 
                                    <option value="‡¶∏‡ßã‡¶∂‡ßç‡¶Ø‡¶æ‡¶≤ ‡¶è‡¶° ‡¶¶‡ßá‡¶ñ‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø">‡¶∏‡ßã‡¶∂‡ßç‡¶Ø‡¶æ‡¶≤ ‡¶è‡¶° ‡¶¶‡ßá‡¶ñ‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø</option>
                                    <option value="‡¶â‡¶≠‡¶Ø‡¶º">‡¶â‡¶≠‡¶Ø‡¶º</option>
                                </select>
                            </div>
                        </div>
                        <div class="text-center">
                            <button type="submit" class="btn btn-primary btn-lg">
                                <i class="bi bi-check-circle"></i> ‡¶∏‡¶æ‡¶¨‡¶Æ‡¶ø‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®
                            </button>
                        </div>
                    </form>
                </div>

                <!-- Recent Entries Section -->
                <div class="glass-card mt-4">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h4 class="mb-0"><i class="bi bi-list-check"></i> ‡¶∏‡¶ï‡¶≤ ‡¶è‡¶®‡ßç‡¶ü‡ßç‡¶∞‡¶ø</h4>
                        <div>
                            <button class="btn btn-success btn-sm me-2" onclick="downloadAllEntriesExcel()" title="‡¶è‡¶ï‡ßç‡¶∏‡ßá‡¶≤ ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶°">
                                <i class="bi bi-file-earmark-excel"></i> ‡¶è‡¶ï‡ßç‡¶∏‡ßá‡¶≤ ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶°
                            </button>
                            <button class="btn btn-primary btn-sm" onclick="loadFromGoogleSheets()" title="‡¶∞‡¶ø‡¶´‡ßç‡¶∞‡ßá‡¶∂ ‡¶ï‡¶∞‡ßÅ‡¶®">
                                <i class="bi bi-arrow-clockwise"></i> ‡¶∞‡¶ø‡¶´‡ßç‡¶∞‡ßá‡¶∂
                            </button>
                        </div>
                    </div>

                    <!-- Summary Stats -->
                    <div class="row mb-3">
                        <div class="col-lg-3 col-md-6 col-sm-6 mb-2">
                            <div class="stat-card" style="border-left-color: #00b0f0; padding: 15px;">
                                <div class="stat-card-icon" style="width: 50px; height: 50px;">
                                    <i class="bi bi-list-ol text-primary fs-3"></i>
                                </div>
                                <div class="stat-card-content">
                                    <div class="stat-number" id="surveyTotalEntries" style="font-size: 1.8rem;">0</div>
                                    <p class="text-muted mb-0" style="font-size: 0.9rem;">‡¶Æ‡ßã‡¶ü ‡¶è‡¶®‡ßç‡¶ü‡ßç‡¶∞‡¶ø</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-3 col-md-6 col-sm-6 mb-2">
                            <div class="stat-card" style="border-left-color: #00a651; padding: 15px;">
                                <div class="stat-card-icon" style="width: 50px; height: 50px;">
                                    <i class="bi bi-check-circle-fill text-success fs-3"></i>
                                </div>
                                <div class="stat-card-content">
                                    <div class="stat-number" id="surveyMyGPUsers" style="font-size: 1.8rem;">0</div>
                                    <p class="text-muted mb-0" style="font-size: 0.9rem;">MyGP ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-2 col-md-4 col-sm-6 mb-2">
                            <div class="stat-card" style="border-left-color: #6f42c1; padding: 15px;">
                                <div class="stat-card-icon" style="width: 50px; height: 50px;">
                                    <i class="bi bi-database-fill fs-3" style="color: #6f42c1;"></i>
                                </div>
                                <div class="stat-card-content">
                                    <div class="stat-number" id="surveyMbCheckers" style="font-size: 1.8rem;">0</div>
                                    <small class="text-muted" id="surveyMbCheckersPercent">0%</small>
                                    <p class="text-muted mb-0" style="font-size: 0.8rem;">‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü/‡¶°‡¶æ‡¶ü‡¶æ</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-2 col-md-4 col-sm-6 mb-2">
                            <div class="stat-card" style="border-left-color: #e83e8c; padding: 15px;">
                                <div class="stat-card-icon" style="width: 50px; height: 50px;">
                                    <i class="bi bi-badge-ad-fill fs-3" style="color: #e83e8c;"></i>
                                </div>
                                <div class="stat-card-content">
                                    <div class="stat-number" id="surveyAdViewers" style="font-size: 1.8rem;">0</div>
                                    <small class="text-muted" id="surveyAdViewersPercent">0%</small>
                                    <p class="text-muted mb-0" style="font-size: 0.8rem;">‡¶∏‡ßã‡¶∂‡ßç‡¶Ø‡¶æ‡¶≤ ‡¶è‡¶°</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-2 col-md-4 col-sm-6 mb-2">
                            <div class="stat-card" style="border-left-color: #20c997; padding: 15px;">
                                <div class="stat-card-icon" style="width: 50px; height: 50px;">
                                    <i class="bi bi-check2-all fs-3" style="color: #20c997;"></i>
                                </div>
                                <div class="stat-card-content">
                                    <div class="stat-number" id="surveyBothReasons" style="font-size: 1.8rem;">0</div>
                                    <small class="text-muted" id="surveyBothReasonsPercent">0%</small>
                                    <p class="text-muted mb-0" style="font-size: 0.8rem;">‡¶â‡¶≠‡¶Ø‡¶º</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Entries Table -->
                    <div class="table-responsive" style="max-height: 500px; overflow-y: auto;">
                        <table class="table table-striped table-hover">
                            <thead style="background: linear-gradient(135deg, #00b0f0 0%, #0088cc 100%); color: white; position: sticky; top: 0; z-index: 10;">
                                <tr>
                                    <th>‡¶ï‡ßç‡¶∞‡¶Æ‡¶ø‡¶ï</th>
                                    <th>‡¶®‡¶æ‡¶Æ</th>
                                    <th>‡¶´‡ßã‡¶® ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞</th>
                                    <th>‡¶™‡ßá‡¶∂‡¶æ</th>
                                    <th>MyGP ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞</th>
                                    <th>‡¶ï‡¶æ‡¶∞‡¶£</th>
                                    <th>‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ</th>
                                </tr>
                            </thead>
                            <tbody id="surveyEntriesTableBody">
                                <tr>
                                    <td colspan="7" class="text-center text-muted py-5">
                                        <i class="bi bi-inbox fs-1 d-block mb-2"></i>
                                        ‡¶ï‡ßã‡¶® ‡¶°‡ßá‡¶ü‡¶æ ‡¶®‡ßá‡¶á
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Dashboard Tab -->
            <div class="tab-pane fade" id="dashboard" role="tabpanel">
                <div class="glass-card">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h3 class="mb-0"><i class="bi bi-graph-up-arrow"></i> ‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡ßá ‡¶°‡ßç‡¶Ø‡¶æ‡¶∂‡¶¨‡ßã‡¶∞‡ßç‡¶°</h3>
                        <button class="btn btn-primary btn-sm" onclick="loadFromGoogleSheets()" title="‡¶∞‡¶ø‡¶´‡ßç‡¶∞‡ßá‡¶∂ ‡¶ï‡¶∞‡ßÅ‡¶®">
                            <i class="bi bi-arrow-clockwise"></i> ‡¶∞‡¶ø‡¶´‡ßç‡¶∞‡ßá‡¶∂
                        </button>
                    </div>
                    <div class="row" id="dashboardStats">
                        <div class="col-md-3 col-sm-6 mb-3">
                            <div class="stat-card">
                                <div class="stat-card-icon">
                                    <i class="bi bi-people-fill text-primary fs-2"></i>
                                </div>
                                <div class="stat-card-content">
                                    <div class="stat-number" id="totalSurveyed">0</div>
                                    <p class="text-muted mb-0">‡¶Æ‡ßã‡¶ü ‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡ßá‡¶ï‡ßÉ‡¶§</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3 col-sm-6 mb-3">
                            <div class="stat-card">
                                <div class="stat-card-icon">
                                    <i class="bi bi-phone-fill text-success fs-2"></i>
                                </div>
                                <div class="stat-card-content">
                                    <div class="stat-number" id="myGPUsers">0</div>
                                    <p class="text-muted mb-0">MyGP ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3 col-sm-6 mb-3">
                            <div class="stat-card">
                                <div class="stat-card-icon">
                                    <i class="bi bi-badge-ad-fill text-info fs-2"></i>
                                </div>
                                <div class="stat-card-content">
                                    <div class="stat-number" id="adViewers">0</div>
                                    <small class="text-muted" id="adViewersPercentDash">0%</small>
                                    <p class="text-muted mb-0" style="font-size: 0.9rem;">‡¶∏‡ßã‡¶∂‡ßç‡¶Ø‡¶æ‡¶≤ ‡¶è‡¶° ‡¶¶‡ßá‡¶ñ‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3 col-sm-6 mb-3">
                            <div class="stat-card">
                                <div class="stat-card-icon">
                                    <i class="bi bi-database-fill text-warning fs-2"></i>
                                </div>
                                <div class="stat-card-content">
                                    <div class="stat-number" id="mbCheckers">0</div>
                                    <small class="text-muted" id="mbCheckersPercentDash">0%</small>
                                    <p class="text-muted mb-0" style="font-size: 0.9rem;">‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü/‡¶°‡¶æ‡¶ü‡¶æ ‡¶¶‡ßá‡¶ñ‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row mt-4">
                        <div class="col-md-6">
                            <div class="chart-container">
                                <canvas id="professionChart"></canvas>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="chart-container">
                                <canvas id="usageChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Reports Tab -->
            <div class="tab-pane fade" id="reports" role="tabpanel">
                <div class="glass-card">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h3 class="mb-0"><i class="bi bi-file-earmark-bar-graph"></i> ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü</h3>
                        <button class="btn btn-primary btn-sm" onclick="loadFromGoogleSheets()" title="‡¶∞‡¶ø‡¶´‡ßç‡¶∞‡ßá‡¶∂ ‡¶ï‡¶∞‡ßÅ‡¶®">
                            <i class="bi bi-arrow-clockwise"></i> ‡¶∞‡¶ø‡¶´‡ßç‡¶∞‡ßá‡¶∂
                        </button>
                    </div>
                    <div id="professionReports">
                        <!-- Profession cards will be dynamically generated here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="footer">
            <p class="mb-0">
                <i class="bi bi-code-slash"></i> Developed by: <a href="https://fb.com/armanaazij" target="_blank">Arman Azij</a>
            </p>
        </div>
    </div>

    <!-- Floating Button -->
    <button class="floating-btn" onclick="exportData()">
        <i class="bi bi-download"></i>
    </button>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Loader Overlay -->
    <div class="loader-overlay" id="loaderOverlay">
        <div class="loader-content">
            <div class="spinner"></div>
            <div class="loader-text">‡¶∏‡¶æ‡¶¨‡¶Æ‡¶ø‡¶ü ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</div>
            <div class="loader-subtext">‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®</div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Google Apps Script Web App URL (‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ URL ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá)
        const GOOGLE_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzVBtlDbLdAmpDpkSary5JSd_ZVuVh30S1OTqRt7duntTGokGMQpVVbMzyj_PD5XJnaCg/exec";

        // Data Management
        let surveyData = [];
        let autoRefreshInterval = null;

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            // localStorage ‡¶•‡ßá‡¶ï‡ßá ‡¶°‡ßá‡¶ü‡¶æ ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ (‡¶Ø‡¶¶‡¶ø ‡¶á‡¶®‡ßç‡¶ü‡¶æ‡¶∞‡¶®‡ßá‡¶ü ‡¶®‡¶æ ‡¶•‡¶æ‡¶ï‡ßá)
            surveyData = JSON.parse(localStorage.getItem('surveyData')) || [];
            updateDashboard();
            generateProfessionReports();
            initializeCharts();
            updateAllEntriesTab();
            updateSurveyFormTable();
            
            // Google Sheets ‡¶•‡ßá‡¶ï‡ßá ‡¶°‡ßá‡¶ü‡¶æ ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡¶æ (silent mode - ‡¶ï‡ßã‡¶® notification ‡¶¶‡ßá‡¶ñ‡¶æ‡¶¨‡ßá ‡¶®‡¶æ)
            loadFromGoogleSheets(false);
            
            // Auto-refresh: ‡¶™‡ßç‡¶∞‡¶§‡¶ø 30 ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶°‡ßá ‡¶°‡ßá‡¶ü‡¶æ ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ
            startAutoRefresh();
            
            // Phone number input ‡¶è ‡¶´‡ßã‡¶ï‡¶æ‡¶∏ ‡¶ï‡¶∞‡¶≤‡ßá "88" ‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§ ‡¶ï‡¶∞‡¶æ
            const phoneInput = document.getElementById('phoneNumber');
            phoneInput.addEventListener('focus', function() {
                if (this.value === '') {
                    this.value = '88';
                }
            });
        });

        // Auto-refresh ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡¶æ
        function startAutoRefresh() {
            // ‡¶Ü‡¶ó‡ßá‡¶∞ interval clear ‡¶ï‡¶∞‡¶æ
            if (autoRefreshInterval) {
                clearInterval(autoRefreshInterval);
            }
            
            // ‡¶™‡ßç‡¶∞‡¶§‡¶ø 30 ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶°‡ßá auto-refresh
            autoRefreshInterval = setInterval(function() {
                console.log('üîÑ Auto-refreshing data...');
                loadFromGoogleSheets(false); // silent mode
            }, 30000); // 30 seconds
            
            console.log('‚úì Auto-refresh started (every 30 seconds)');
        }

        // Auto-refresh ‡¶¨‡¶®‡ßç‡¶ß ‡¶ï‡¶∞‡¶æ (‡¶Ø‡¶¶‡¶ø ‡¶¶‡¶∞‡¶ï‡¶æ‡¶∞ ‡¶π‡¶Ø‡¶º)
        function stopAutoRefresh() {
            if (autoRefreshInterval) {
                clearInterval(autoRefreshInterval);
                autoRefreshInterval = null;
                console.log('Auto-refresh stopped');
            }
        }

        // Google Sheets ‡¶•‡ßá‡¶ï‡ßá ‡¶°‡ßá‡¶ü‡¶æ ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ
        async function loadFromGoogleSheets(showNotification = true) {
            try {
                console.log('=== Loading data from Google Sheets ===');
                console.log('URL:', `${GOOGLE_SCRIPT_URL}?action=getData`);
                console.log('Timestamp:', new Date().toISOString());
                
                const response = await fetch(`${GOOGLE_SCRIPT_URL}?action=getData&t=${Date.now()}`, {
                    method: 'GET',
                    headers: {
                        'Accept': 'application/json'
                    },
                    cache: 'no-cache'
                });
                
                console.log('Response status:', response.status);
                console.log('Response OK:', response.ok);
                
                if (response.ok) {
                    const textResponse = await response.text();
                    console.log('Raw response length:', textResponse.length);
                    console.log('Raw response (first 500 chars):', textResponse.substring(0, 500));
                    
                    try {
                        const data = JSON.parse(textResponse);
                        console.log('Parsed data status:', data.status);
                        console.log('Data array length:', data.data ? data.data.length : 0);
                        
                        if (data.status === "success" && data.data && Array.isArray(data.data)) {
                            // ‡¶Ü‡¶ó‡ßá‡¶∞ ‡¶°‡ßá‡¶ü‡¶æ‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá compare ‡¶ï‡¶∞‡¶æ
                            const oldLength = surveyData.length;
                            surveyData = data.data;
                            localStorage.setItem('surveyData', JSON.stringify(surveyData));
                            
                            console.log(`‚úì Survey data loaded successfully!`);
                            console.log(`  - Previous entries: ${oldLength}`);
                            console.log(`  - Current entries: ${surveyData.length}`);
                            console.log(`  - New entries: ${surveyData.length - oldLength}`);
                            
                            // UI Update ‡¶ï‡¶∞‡¶æ
                            updateDashboard();
                            generateProfessionReports();
                            updateCharts();
                            updateAllEntriesTab();
                            updateSurveyFormTable();
                            
                            if (showNotification) {
                                if (surveyData.length > oldLength) {
                                    showToast(`‚úì ${surveyData.length} ‡¶ü‡¶ø ‡¶è‡¶®‡ßç‡¶ü‡ßç‡¶∞‡¶ø ‡¶≤‡ßã‡¶° ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá (${surveyData.length - oldLength} ‡¶ü‡¶ø ‡¶®‡¶§‡ßÅ‡¶®)`, 'success');
                                } else {
                                    showToast(`‚úì ${surveyData.length} ‡¶ü‡¶ø ‡¶è‡¶®‡ßç‡¶ü‡ßç‡¶∞‡¶ø ‡¶≤‡ßã‡¶° ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá`, 'success');
                                }
                            }
                            
                            console.log('=== Data loading completed successfully ===');
                        } else if (data.status === "error") {
                            console.error('Server returned error:', data.message);
                            if (showNotification) {
                                showToast('‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡¶æ‡¶∞ ‡¶è‡¶∞‡¶∞: ' + data.message, 'error');
                            }
                        } else {
                            console.warn('Invalid data format:', data);
                            if (showNotification) {
                                showToast('‡¶°‡ßá‡¶ü‡¶æ ‡¶´‡¶∞‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ü ‡¶∏‡¶†‡¶ø‡¶ï ‡¶®‡¶Ø‡¶º', 'warning');
                            }
                        }
                    } catch (parseError) {
                        console.error('‚ùå JSON parse error:', parseError);
                        console.error('Response text:', textResponse);
                        if (showNotification) {
                            showToast('‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡¶æ‡¶∞ ‡¶•‡ßá‡¶ï‡ßá ‡¶∏‡¶†‡¶ø‡¶ï JSON ‡¶°‡ßá‡¶ü‡¶æ ‡¶Ü‡¶∏‡ßá‡¶®‡¶ø', 'error');
                        }
                    }
                } else {
                    const errorText = await response.text();
                    console.error('‚ùå Response not OK');
                    console.error('Status:', response.status);
                    console.error('Error text:', errorText);
                    if (showNotification) {
                        showToast(`‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡¶æ‡¶∞ ‡¶è‡¶∞‡¶∞ (${response.status})`, 'error');
                    }
                }
            } catch (error) {
                console.error("‚ùå Google Sheets ‡¶•‡ßá‡¶ï‡ßá ‡¶°‡ßá‡¶ü‡¶æ ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ:");
                console.error("Error message:", error.message);
                console.error("Error stack:", error.stack);
                
                // ‡¶∂‡ßÅ‡¶ß‡ßÅ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞ ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßÅ‡¶Ø‡¶º‡¶æ‡¶≤ ‡¶∞‡¶ø‡¶´‡ßç‡¶∞‡ßá‡¶∂‡ßá‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º error ‡¶¶‡ßá‡¶ñ‡¶æ‡¶¨‡ßá
                if (showNotification) {
                    showToast('‡¶á‡¶®‡ßç‡¶ü‡¶æ‡¶∞‡¶®‡ßá‡¶ü ‡¶∏‡¶Ç‡¶Ø‡ßã‡¶ó ‡¶¨‡¶æ ‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡¶æ‡¶∞ ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶Ü‡¶õ‡ßá', 'warning');
                }
            }
        }

        // Show Loader
        function showLoader() {
            document.getElementById('loaderOverlay').classList.add('show');
        }

        // Hide Loader
        function hideLoader() {
            document.getElementById('loaderOverlay').classList.remove('show');
        }

        // Form Handling
        document.getElementById('surveyForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            // Show loader
            showLoader();
            
            const formData = {
                id: Date.now(),
                name: document.getElementById('name').value,
                phoneNumber: document.getElementById('phoneNumber').value,
                profession: document.getElementById('profession').value,
                useMyGP: document.querySelector('input[name="useMyGP"]:checked').value,
                reason: document.getElementById('reason').value,
                timestamp: new Date().toISOString()
            };

            // ‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡ßá localStorage ‡¶è ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£ ‡¶ï‡¶∞‡¶æ
            surveyData.push(formData);
            localStorage.setItem('surveyData', JSON.stringify(surveyData));
            
            // Google Sheets ‡¶è ‡¶°‡ßá‡¶ü‡¶æ ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡¶æ
            try {
                const response = await fetch(GOOGLE_SCRIPT_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                    },
                    body: new URLSearchParams(formData)
                });
                
                if (response.ok) {
                    const result = await response.json();
                    if (result.status === "success") {
                        hideLoader();
                        showToast('‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡ßá ‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶ú‡¶Æ‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá ‡¶è‡¶¨‡¶Ç Google Sheets ‡¶è ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶ø‡¶§ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!', 'success');
                    } else {
                        hideLoader();
                        showToast('‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡ßá ‡¶ú‡¶Æ‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá, ‡¶ï‡¶ø‡¶®‡ßç‡¶§‡ßÅ Google Sheets ‡¶è ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£ ‡¶ï‡¶∞‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá: ' + result.message, 'warning');
                    }
                } else {
                    hideLoader();
                    showToast('‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡ßá ‡¶ú‡¶Æ‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá, ‡¶ï‡¶ø‡¶®‡ßç‡¶§‡ßÅ Google Sheets ‡¶è ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£ ‡¶ï‡¶∞‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá', 'warning');
                }
            } catch (error) {
                console.error("Google Sheets ‡¶è ‡¶°‡ßá‡¶ü‡¶æ ‡¶™‡¶æ‡¶†‡¶æ‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ:", error);
                hideLoader();
                showToast('‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡ßá ‡¶ú‡¶Æ‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá, ‡¶ï‡¶ø‡¶®‡ßç‡¶§‡ßÅ ‡¶á‡¶®‡ßç‡¶ü‡¶æ‡¶∞‡¶®‡ßá‡¶ü ‡¶∏‡¶Ç‡¶Ø‡ßã‡¶ó ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ‡¶∞ ‡¶ï‡¶æ‡¶∞‡¶£‡ßá Google Sheets ‡¶è ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£ ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø', 'warning');
            }
            
            this.reset();
            document.getElementById('reason').disabled = true;
            
            updateDashboard();
            generateProfessionReports();
            updateCharts();
            updateAllEntriesTab();
            updateSurveyFormTable();
        });

        // Enable/Disable Reason Field
        document.querySelectorAll('input[name="useMyGP"]').forEach(radio => {
            radio.addEventListener('change', function() {
                const reasonField = document.getElementById('reason');
                if (this.value === 'yes') {
                    reasonField.disabled = false;
                    reasonField.required = true;
                } else {
                    reasonField.disabled = true;
                    reasonField.required = false;
                    reasonField.value = '';
                }
            });
        });

        // Update Dashboard
        function updateDashboard() {
            const totalSurveyed = surveyData.length;
            const myGPUsers = surveyData.filter(d => d.useMyGP === 'yes').length;
            
            // ‡¶ï‡¶æ‡¶∞‡¶£ ‡¶≠‡¶ø‡¶§‡ßç‡¶§‡¶ø‡¶ï ‡¶ó‡¶£‡¶®‡¶æ (‡¶∏‡¶†‡¶ø‡¶ï ‡¶´‡¶ø‡¶≤‡ßç‡¶ü‡¶æ‡¶∞)
            const adViewers = surveyData.filter(d => d.reason === '‡¶∏‡ßã‡¶∂‡ßç‡¶Ø‡¶æ‡¶≤ ‡¶è‡¶° ‡¶¶‡ßá‡¶ñ‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø').length;
            const mbCheckers = surveyData.filter(d => d.reason === '‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü/‡¶°‡¶æ‡¶ü‡¶æ ‡¶¶‡ßá‡¶ñ‡¶æ ‡¶¨‡¶æ ‡¶ï‡ßç‡¶∞‡¶Ø‡¶º ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø').length;
            
            // ‡¶∂‡¶§‡¶ï‡¶∞‡¶æ ‡¶π‡¶æ‡¶∞ ‡¶π‡¶ø‡¶∏‡¶æ‡¶¨
            const adViewersPercent = myGPUsers > 0 ? Math.round((adViewers/myGPUsers)*100) : 0;
            const mbCheckersPercent = myGPUsers > 0 ? Math.round((mbCheckers/myGPUsers)*100) : 0;

            console.log('=== Dashboard Stats ===');
            console.log('Total Surveyed:', totalSurveyed);
            console.log('MyGP Users:', myGPUsers);
            console.log('Ad Viewers:', adViewers, `(${adViewersPercent}%)`);
            console.log('MB Checkers:', mbCheckers, `(${mbCheckersPercent}%)`);

            animateNumber('totalSurveyed', totalSurveyed);
            animateNumber('myGPUsers', myGPUsers);
            animateNumber('adViewers', adViewers);
            animateNumber('mbCheckers', mbCheckers);
            
            // Update percentages
            const adPercentEl = document.getElementById('adViewersPercentDash');
            if (adPercentEl) adPercentEl.textContent = adViewersPercent + '%';
            
            const mbPercentEl = document.getElementById('mbCheckersPercentDash');
            if (mbPercentEl) mbPercentEl.textContent = mbCheckersPercent + '%';
        }

        // Animate Numbers
        function animateNumber(elementId, target) {
            const element = document.getElementById(elementId);
            if (!element) {
                console.warn(`Element with id '${elementId}' not found`);
                return;
            }
            const start = parseInt(element.textContent) || 0;
            const increment = (target - start) / 20;
            let current = start;
            
            const timer = setInterval(() => {
                current += increment;
                if ((increment > 0 && current >= target) || (increment < 0 && current <= target)) {
                    element.textContent = target;
                    clearInterval(timer);
                } else {
                    element.textContent = Math.round(current);
                }
            }, 50);
        }

        // Update All Entries Tab
        function updateAllEntriesTab() {
            // Check if the "All Entries" tab exists (it was removed)
            const tbody = document.getElementById('allEntriesTableBody');
            if (!tbody) {
                console.log('All Entries Tab removed - skipping update');
                return;
            }
            
            const totalEntries = surveyData.length;
            const myGPUsers = surveyData.filter(d => d.useMyGP === 'yes').length;
            
            // ‡¶ï‡¶æ‡¶∞‡¶£ ‡¶≠‡¶ø‡¶§‡ßç‡¶§‡¶ø‡¶ï ‡¶ó‡¶£‡¶®‡¶æ
            const mbCheckers = surveyData.filter(d => d.reason === '‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü/‡¶°‡¶æ‡¶ü‡¶æ ‡¶¶‡ßá‡¶ñ‡¶æ ‡¶¨‡¶æ ‡¶ï‡ßç‡¶∞‡¶Ø‡¶º ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø').length;
            const adViewers = surveyData.filter(d => d.reason === '‡¶∏‡ßã‡¶∂‡ßç‡¶Ø‡¶æ‡¶≤ ‡¶è‡¶° ‡¶¶‡ßá‡¶ñ‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø').length;
            const bothReasons = surveyData.filter(d => d.reason === '‡¶â‡¶≠‡¶Ø‡¶º').length;
            
            // ‡¶∂‡¶§‡¶ï‡¶∞‡¶æ ‡¶π‡¶æ‡¶∞ ‡¶π‡¶ø‡¶∏‡¶æ‡¶¨ (MyGP users ‡¶è‡¶∞ ‡¶≠‡¶ø‡¶§‡ßç‡¶§‡¶ø‡¶§‡ßá)
            const mbCheckersPercentage = myGPUsers > 0 ? Math.round((mbCheckers/myGPUsers)*100) : 0;
            const adViewersPercentage = myGPUsers > 0 ? Math.round((adViewers/myGPUsers)*100) : 0;
            const bothReasonsPercentage = myGPUsers > 0 ? Math.round((bothReasons/myGPUsers)*100) : 0;

            console.log('=== All Entries Tab Stats ===');
            console.log('Total Entries:', totalEntries);
            console.log('MyGP Users:', myGPUsers);
            console.log('MB Checkers:', mbCheckers, `(${mbCheckersPercentage}%)`);
            console.log('Ad Viewers:', adViewers, `(${adViewersPercentage}%)`);
            console.log('Both Reasons:', bothReasons, `(${bothReasonsPercentage}%)`);

            // Update summary cards
            console.log('Updating allTotalEntries:', totalEntries);
            animateNumber('allTotalEntries', totalEntries);
            
            console.log('Updating allMyGPUsers:', myGPUsers);
            animateNumber('allMyGPUsers', myGPUsers);
            
            // Update reason-based cards
            console.log('Updating mbCheckersCount:', mbCheckers);
            animateNumber('mbCheckersCount', mbCheckers);
            const mbPercentEl = document.getElementById('mbCheckersPercentage');
            if (mbPercentEl) {
                mbPercentEl.textContent = mbCheckersPercentage + '%';
                console.log('Set mbCheckersPercentage to:', mbCheckersPercentage + '%');
            } else {
                console.error('mbCheckersPercentage element not found!');
            }
            
            console.log('Updating adViewersCount:', adViewers);
            animateNumber('adViewersCount', adViewers);
            const adPercentEl = document.getElementById('adViewersPercentage');
            if (adPercentEl) {
                adPercentEl.textContent = adViewersPercentage + '%';
                console.log('Set adViewersPercentage to:', adViewersPercentage + '%');
            } else {
                console.error('adViewersPercentage element not found!');
            }
            
            console.log('Updating bothReasonsCount:', bothReasons);
            animateNumber('bothReasonsCount', bothReasons);
            const bothPercentEl = document.getElementById('bothReasonsPercentage');
            if (bothPercentEl) {
                bothPercentEl.textContent = bothReasonsPercentage + '%';
                console.log('Set bothReasonsPercentage to:', bothReasonsPercentage + '%');
            } else {
                console.error('bothReasonsPercentage element not found!');
            }
            
            if (surveyData.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="7" class="text-center text-muted py-5">
                            <i class="bi bi-inbox fs-1 d-block mb-2"></i>
                            ‡¶ï‡ßã‡¶® ‡¶°‡ßá‡¶ü‡¶æ ‡¶®‡ßá‡¶á
                        </td>
                    </tr>
                `;
                return;
            }

            tbody.innerHTML = '';
            surveyData.forEach((d, index) => {
                const row = `
                    <tr>
                        <td>${index + 1}</td>
                        <td>${d.name || '-'}</td>
                        <td>${d.phoneNumber}</td>
                        <td>${d.profession}</td>
                        <td>${d.useMyGP === 'yes' ? '<span class="badge bg-success">‡¶π‡ßç‡¶Ø‡¶æ‡¶Å</span>' : '<span class="badge bg-danger">‡¶®‡¶æ</span>'}</td>
                        <td>${d.reason || '-'}</td>
                        <td>${new Date(d.timestamp).toLocaleDateString('bn-BD')}</td>
                    </tr>
                `;
                tbody.innerHTML += row;
            });
        }

        // Update Survey Form Tab Table
        function updateSurveyFormTable() {
            const totalEntries = surveyData.length;
            const myGPUsers = surveyData.filter(d => d.useMyGP === 'yes').length;
            
            // ‡¶ï‡¶æ‡¶∞‡¶£ ‡¶≠‡¶ø‡¶§‡ßç‡¶§‡¶ø‡¶ï ‡¶ó‡¶£‡¶®‡¶æ
            const mbCheckers = surveyData.filter(d => d.reason === '‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü/‡¶°‡¶æ‡¶ü‡¶æ ‡¶¶‡ßá‡¶ñ‡¶æ ‡¶¨‡¶æ ‡¶ï‡ßç‡¶∞‡¶Ø‡¶º ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø').length;
            const adViewers = surveyData.filter(d => d.reason === '‡¶∏‡ßã‡¶∂‡ßç‡¶Ø‡¶æ‡¶≤ ‡¶è‡¶° ‡¶¶‡ßá‡¶ñ‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø').length;
            const bothReasons = surveyData.filter(d => d.reason === '‡¶â‡¶≠‡¶Ø‡¶º').length;
            
            // ‡¶∂‡¶§‡¶ï‡¶∞‡¶æ ‡¶π‡¶æ‡¶∞ ‡¶π‡¶ø‡¶∏‡¶æ‡¶¨
            const mbCheckersPercent = myGPUsers > 0 ? Math.round((mbCheckers/myGPUsers)*100) : 0;
            const adViewersPercent = myGPUsers > 0 ? Math.round((adViewers/myGPUsers)*100) : 0;
            const bothReasonsPercent = myGPUsers > 0 ? Math.round((bothReasons/myGPUsers)*100) : 0;

            console.log('=== Survey Form Table Stats ===');
            console.log('Total Entries:', totalEntries);
            console.log('MyGP Users:', myGPUsers);
            console.log('MB Checkers:', mbCheckers, `(${mbCheckersPercent}%)`);
            console.log('Ad Viewers:', adViewers, `(${adViewersPercent}%)`);
            console.log('Both Reasons:', bothReasons, `(${bothReasonsPercent}%)`);

            // Update summary cards in survey form tab
            animateNumber('surveyTotalEntries', totalEntries);
            animateNumber('surveyMyGPUsers', myGPUsers);
            
            animateNumber('surveyMbCheckers', mbCheckers);
            const mbPercentEl = document.getElementById('surveyMbCheckersPercent');
            if (mbPercentEl) mbPercentEl.textContent = mbCheckersPercent + '%';
            
            animateNumber('surveyAdViewers', adViewers);
            const adPercentEl = document.getElementById('surveyAdViewersPercent');
            if (adPercentEl) adPercentEl.textContent = adViewersPercent + '%';
            
            animateNumber('surveyBothReasons', bothReasons);
            const bothPercentEl = document.getElementById('surveyBothReasonsPercent');
            if (bothPercentEl) bothPercentEl.textContent = bothReasonsPercent + '%';

            // Update table
            const tbody = document.getElementById('surveyEntriesTableBody');
            
            if (surveyData.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="7" class="text-center text-muted py-5">
                            <i class="bi bi-inbox fs-1 d-block mb-2"></i>
                            ‡¶ï‡ßã‡¶® ‡¶°‡ßá‡¶ü‡¶æ ‡¶®‡ßá‡¶á
                        </td>
                    </tr>
                `;
                return;
            }

            tbody.innerHTML = '';
            // Show latest entries first (reversed order)
            [...surveyData].reverse().forEach((d, index) => {
                const row = `
                    <tr>
                        <td>${surveyData.length - index}</td>
                        <td>${d.name || '-'}</td>
                        <td>${d.phoneNumber}</td>
                        <td>${d.profession}</td>
                        <td>${d.useMyGP === 'yes' ? '<span class="badge bg-success">‡¶π‡ßç‡¶Ø‡¶æ‡¶Å</span>' : '<span class="badge bg-danger">‡¶®‡¶æ</span>'}</td>
                        <td>${d.reason || '-'}</td>
                        <td>${new Date(d.timestamp).toLocaleDateString('bn-BD')}</td>
                    </tr>
                `;
                tbody.innerHTML += row;
            });
        }

        // Debug All Data
        function debugAllData() {
            console.clear();
            console.log('==========================================');
            console.log('       DEBUG: ALL DATA ANALYSIS          ');
            console.log('==========================================');
            console.log('Survey Data:', surveyData);
            console.log('Total Entries:', surveyData.length);
            
            const myGPUsers = surveyData.filter(d => d.useMyGP === 'yes');
            console.log('\n--- MyGP Users ---');
            console.log('Count:', myGPUsers.length);
            console.log('Data:', myGPUsers);
            
            const mbCheckers = surveyData.filter(d => d.reason === '‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü/‡¶°‡¶æ‡¶ü‡¶æ ‡¶¶‡ßá‡¶ñ‡¶æ ‡¶¨‡¶æ ‡¶ï‡ßç‡¶∞‡¶Ø‡¶º ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø');
            console.log('\n--- ‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü/‡¶°‡¶æ‡¶ü‡¶æ ‡¶¶‡ßá‡¶ñ‡¶æ ‡¶¨‡¶æ ‡¶ï‡ßç‡¶∞‡¶Ø‡¶º ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ---');
            console.log('Count:', mbCheckers.length);
            console.log('Percentage:', myGPUsers.length > 0 ? Math.round((mbCheckers.length/myGPUsers.length)*100) : 0, '%');
            console.log('Data:', mbCheckers);
            
            const adViewers = surveyData.filter(d => d.reason === '‡¶∏‡ßã‡¶∂‡ßç‡¶Ø‡¶æ‡¶≤ ‡¶è‡¶° ‡¶¶‡ßá‡¶ñ‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø');
            console.log('\n--- ‡¶∏‡ßã‡¶∂‡ßç‡¶Ø‡¶æ‡¶≤ ‡¶è‡¶° ‡¶¶‡ßá‡¶ñ‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ---');
            console.log('Count:', adViewers.length);
            console.log('Percentage:', myGPUsers.length > 0 ? Math.round((adViewers.length/myGPUsers.length)*100) : 0, '%');
            console.log('Data:', adViewers);
            
            const bothReasons = surveyData.filter(d => d.reason === '‡¶â‡¶≠‡¶Ø‡¶º');
            console.log('\n--- ‡¶â‡¶≠‡¶Ø‡¶º ---');
            console.log('Count:', bothReasons.length);
            console.log('Percentage:', myGPUsers.length > 0 ? Math.round((bothReasons.length/myGPUsers.length)*100) : 0, '%');
            console.log('Data:', bothReasons);
            
            console.log('\n--- Unique Reasons ---');
            const uniqueReasons = [...new Set(surveyData.map(d => d.reason))];
            uniqueReasons.forEach(reason => {
                const count = surveyData.filter(d => d.reason === reason).length;
                console.log(`"${reason}":`, count);
            });
            
            console.log('\n--- DOM Elements Check ---');
            console.log('mbCheckersCount element:', document.getElementById('mbCheckersCount'));
            console.log('adViewersCount element:', document.getElementById('adViewersCount'));
            console.log('bothReasonsCount element:', document.getElementById('bothReasonsCount'));
            console.log('mbCheckersPercentage element:', document.getElementById('mbCheckersPercentage'));
            console.log('adViewersPercentage element:', document.getElementById('adViewersPercentage'));
            console.log('bothReasonsPercentage element:', document.getElementById('bothReasonsPercentage'));
            
            console.log('\n==========================================');
            alert('Debug info logged to console. Press F12 to view.');
        }

        // Download All Entries as Excel
        function downloadAllEntriesExcel() {
            console.log('Download Excel clicked. Survey data length:', surveyData.length);
            console.log('Survey data:', surveyData);
            
            if (surveyData.length === 0) {
                showToast('‡¶ï‡ßã‡¶® ‡¶°‡ßá‡¶ü‡¶æ ‡¶®‡ßá‡¶á‡•§ ‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡ßá ‡¶°‡ßá‡¶ü‡¶æ ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßÅ‡¶®‡•§', 'warning');
                return;
            }

            try {
                // Create workbook
                const wb = XLSX.utils.book_new();

                console.log('Creating Excel with', surveyData.length, 'entries');

                // All Data Sheet
                const allDataRows = [
                    ['‡¶ï‡ßç‡¶∞‡¶Æ‡¶ø‡¶ï', '‡¶®‡¶æ‡¶Æ', '‡¶´‡ßã‡¶® ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞', '‡¶™‡ßá‡¶∂‡¶æ', 'MyGP ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞', '‡¶ï‡¶æ‡¶∞‡¶£', '‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ']
                ];

                surveyData.forEach((d, index) => {
                    allDataRows.push([
                        index + 1,
                        d.name || '-',
                        d.phoneNumber || '-',
                        d.profession || '-',
                        d.useMyGP === 'yes' ? '‡¶π‡ßç‡¶Ø‡¶æ‡¶Å' : '‡¶®‡¶æ',
                        d.reason || '-',
                        d.timestamp ? new Date(d.timestamp).toLocaleDateString('bn-BD') : '-'
                    ]);
                });

                console.log('All data rows:', allDataRows.length, 'rows (including header)');

                const allDataSheet = XLSX.utils.aoa_to_sheet(allDataRows);
                allDataSheet['!cols'] = [
                    { wch: 10 },
                    { wch: 20 },
                    { wch: 15 },
                    { wch: 15 },
                    { wch: 15 },
                    { wch: 35 },
                    { wch: 15 }
                ];

                // Add sheet to workbook
                XLSX.utils.book_append_sheet(wb, allDataSheet, '‡¶∏‡¶ï‡¶≤ ‡¶è‡¶®‡ßç‡¶ü‡ßç‡¶∞‡¶ø');

                console.log('Workbook created with sheet:', wb.SheetNames);

                // Download
                const filename = `All_Entries_Report_${new Date().toISOString().split('T')[0]}.xlsx`;
                XLSX.writeFile(wb, filename);
                
                console.log('Excel file downloaded successfully with', surveyData.length, 'entries');
                showToast(`${surveyData.length} ‡¶ü‡¶ø ‡¶è‡¶®‡ßç‡¶ü‡ßç‡¶∞‡¶ø ‡¶∏‡¶π ‡¶è‡¶ï‡ßç‡¶∏‡ßá‡¶≤ ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!`, 'success');
            } catch (error) {
                console.error('Excel download error:', error);
                showToast('‡¶è‡¶ï‡ßç‡¶∏‡ßá‡¶≤ ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá: ' + error.message, 'error');
            }
        }


        // Generate Profession Reports
        function generateProfessionReports() {
            const professions = ['‡¶°‡¶æ‡¶ï‡ßç‡¶§‡¶æ‡¶∞', '‡¶á‡¶û‡ßç‡¶ú‡¶ø‡¶®‡¶ø‡¶Ø‡¶º‡¶æ‡¶∞', '‡¶õ‡¶æ‡¶§‡ßç‡¶∞', '‡¶ö‡¶æ‡¶ï‡ßÅ‡¶∞‡¶ø‡¶ú‡ßÄ‡¶¨‡¶ø', '‡¶¨‡ßç‡¶Ø‡¶¨‡¶∏‡¶æ‡¶Ø‡¶º‡ßÄ', '‡¶™‡¶•‡¶ö‡¶æ‡¶∞‡ßÄ'];
            const icons = {
                '‡¶°‡¶æ‡¶ï‡ßç‡¶§‡¶æ‡¶∞': 'bi-hospital',
                '‡¶á‡¶û‡ßç‡¶ú‡¶ø‡¶®‡¶ø‡¶Ø‡¶º‡¶æ‡¶∞': 'bi-gear',
                '‡¶õ‡¶æ‡¶§‡ßç‡¶∞': 'bi-mortarboard',
                '‡¶ö‡¶æ‡¶ï‡ßÅ‡¶∞‡¶ø‡¶ú‡ßÄ‡¶¨‡¶ø': 'bi-briefcase',
                '‡¶¨‡ßç‡¶Ø‡¶¨‡¶∏‡¶æ‡¶Ø‡¶º‡ßÄ': 'bi-currency-dollar',
                '‡¶™‡¶•‡¶ö‡¶æ‡¶∞‡ßÄ': 'bi-person-walking'
            };

            const reportsContainer = document.getElementById('professionReports');
            reportsContainer.innerHTML = '';

            professions.forEach(profession => {
                const professionData = surveyData.filter(d => d.profession === profession);
                const total = professionData.length;
                const myGPUsers = professionData.filter(d => d.useMyGP === 'yes').length;
                const adViewers = professionData.filter(d => d.reason && d.reason.includes('‡¶è‡¶°')).length;
                const mbCheckers = professionData.filter(d => d.reason && d.reason.includes('‡¶è‡¶Æ‡¶¨‡¶ø')).length;

                const card = `
                    <div class="profession-card" onclick="showProfessionDetail('${profession}')">
                        <div class="profession-header">
                            <h4><i class="bi ${icons[profession]}"></i> ${profession}</h4>
                            <i class="bi bi-file-earmark-text view-report-icon" title="‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®"></i>
                        </div>
                        <div class="row">
                            <div class="col-md-3">
                                <div class="text-center">
                                    <div class="percentage-circle">
                                        <span class="percentage-text">${total}</span>
                                    </div>
                                    <p class="mb-0"><strong>‡¶Æ‡ßã‡¶ü ‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡ßá</strong></p>
                                </div>
                            </div>
                            <div class="col-md-9">
                                <div class="mb-3">
                                    <small class="text-muted">MyGP ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ</small>
                                    <div class="progress">
                                        <div class="progress-bar" style="width: ${total > 0 ? (myGPUsers/total)*100 : 0}%">
                                            ${total > 0 ? Math.round((myGPUsers/total)*100) : 0}%
                                        </div>
                                    </div>
                                </div>
                                <div class="mb-3">
                                    <small class="text-muted">‡¶è‡¶° ‡¶¶‡ßá‡¶ñ‡ßá‡¶®</small>
                                    <div class="progress">
                                        <div class="progress-bar bg-info" style="width: ${total > 0 ? (adViewers/total)*100 : 0}%">
                                            ${total > 0 ? Math.round((adViewers/total)*100) : 0}%
                                        </div>
                                    </div>
                                </div>
                                <div class="mb-3">
                                    <small class="text-muted">‡¶è‡¶Æ‡¶¨‡¶ø ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡ßá‡¶®</small>
                                    <div class="progress">
                                        <div class="progress-bar bg-warning" style="width: ${total > 0 ? (mbCheckers/total)*100 : 0}%">
                                            ${total > 0 ? Math.round((mbCheckers/total)*100) : 0}%
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                reportsContainer.innerHTML += card;
            });
        }

        // Show Profession Detail Modal
        function showProfessionDetail(profession) {
            const professionData = surveyData.filter(d => d.profession === profession);
            const modal = `
                <div class="modal fade" id="professionModal" tabindex="-1">
                    <div class="modal-dialog modal-lg">
                        <div class="modal-content">
                            <div class="modal-header" style="background: linear-gradient(135deg, #00b0f0 0%, #0088cc 100%); color: white;">
                                <h5 class="modal-title"><i class="bi bi-file-earmark-bar-graph"></i> ${profession} - ‡¶¨‡¶ø‡¶∏‡ßç‡¶§‡¶æ‡¶∞‡¶ø‡¶§ ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü</h5>
                                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                            </div>
                            <div class="modal-body">
                                <div class="table-responsive">
                                    <table class="table table-striped table-hover" id="professionTable">
                                        <thead style="background: #f8f9fa;">
                                            <tr>
                                                <th>‡¶ï‡ßç‡¶∞‡¶Æ‡¶ø‡¶ï</th>
                                                <th>‡¶®‡¶æ‡¶Æ</th>
                                                <th>‡¶´‡ßã‡¶® ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞</th>
                                                <th>MyGP ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞</th>
                                                <th>‡¶ï‡¶æ‡¶∞‡¶£</th>
                                                <th>‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            ${professionData.map((d, index) => `
                                                <tr>
                                                    <td>${index + 1}</td>
                                                    <td>${d.name || '-'}</td>
                                                    <td>${d.phoneNumber}</td>
                                                    <td>${d.useMyGP === 'yes' ? '<span class="badge bg-success">‡¶π‡ßç‡¶Ø‡¶æ‡¶Å</span>' : '<span class="badge bg-danger">‡¶®‡¶æ</span>'}</td>
                                                    <td>${d.reason || '-'}</td>
                                                    <td>${new Date(d.timestamp).toLocaleDateString('bn-BD')}</td>
                                                </tr>
                                            `).join('')}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                                    <i class="bi bi-x-circle"></i> ‡¶¨‡¶®‡ßç‡¶ß ‡¶ï‡¶∞‡ßÅ‡¶®
                                </button>
                                <button type="button" class="btn btn-success" onclick="downloadProfessionReport('${profession}')">
                                    <i class="bi bi-file-earmark-excel"></i> ‡¶è‡¶ï‡ßç‡¶∏‡ßá‡¶≤ ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶°
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modal);
            const modalElement = new bootstrap.Modal(document.getElementById('professionModal'));
            modalElement.show();
            
            document.getElementById('professionModal').addEventListener('hidden.bs.modal', function() {
                this.remove();
            });
        }

        // Download Profession Report as Excel
        function downloadProfessionReport(profession) {
            const professionData = surveyData.filter(d => d.profession === profession);
            
            console.log('Profession download:', profession, 'Data count:', professionData.length);
            
            if (professionData.length === 0) {
                showToast('‡¶è‡¶á ‡¶™‡ßá‡¶∂‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶ï‡ßã‡¶® ‡¶°‡ßá‡¶ü‡¶æ ‡¶®‡ßá‡¶á', 'warning');
                return;
            }

            try {
                console.log(`Creating Excel for ${profession} with ${professionData.length} entries`);

                // Create workbook
                const wb = XLSX.utils.book_new();

                // Data Sheet
                const dataRows = [
                    ['‡¶ï‡ßç‡¶∞‡¶Æ‡¶ø‡¶ï', '‡¶®‡¶æ‡¶Æ', '‡¶´‡ßã‡¶® ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞', 'MyGP ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞', '‡¶ï‡¶æ‡¶∞‡¶£', '‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ']
                ];

                professionData.forEach((d, index) => {
                    dataRows.push([
                        index + 1,
                        d.name || '-',
                        d.phoneNumber || '-',
                        d.useMyGP === 'yes' ? '‡¶π‡ßç‡¶Ø‡¶æ‡¶Å' : '‡¶®‡¶æ',
                        d.reason || '-',
                        d.timestamp ? new Date(d.timestamp).toLocaleDateString('bn-BD') : '-'
                    ]);
                });

                console.log('Data rows:', dataRows.length, 'rows (including header)');

                const dataSheet = XLSX.utils.aoa_to_sheet(dataRows);
                dataSheet['!cols'] = [
                    { wch: 10 },
                    { wch: 20 },
                    { wch: 15 },
                    { wch: 15 },
                    { wch: 35 },
                    { wch: 15 }
                ];

                // Add sheet to workbook
                XLSX.utils.book_append_sheet(wb, dataSheet, profession);

                console.log('Workbook created with sheet:', wb.SheetNames);

                // Generate filename
                const filename = `${profession}_Report_${new Date().toISOString().split('T')[0]}.xlsx`;

                // Download
                XLSX.writeFile(wb, filename);
                
                console.log(`Excel report for ${profession} downloaded successfully with ${professionData.length} entries`);
                showToast(`${profession} - ${professionData.length} ‡¶ü‡¶ø ‡¶è‡¶®‡ßç‡¶ü‡ßç‡¶∞‡¶ø ‡¶∏‡¶π ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!`, 'success');
            } catch (error) {
                console.error('Profession Excel download error:', error);
                showToast('‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá: ' + error.message, 'error');
            }
        }


        // Initialize Charts
        let professionChart, usageChart;

        function initializeCharts() {
            // Profession Distribution Chart
            const ctx1 = document.getElementById('professionChart').getContext('2d');
            professionChart = new Chart(ctx1, {
                type: 'doughnut',
                data: {
                    labels: ['‡¶°‡¶æ‡¶ï‡ßç‡¶§‡¶æ‡¶∞', '‡¶á‡¶û‡ßç‡¶ú‡¶ø‡¶®‡¶ø‡¶Ø‡¶º‡¶æ‡¶∞', '‡¶õ‡¶æ‡¶§‡ßç‡¶∞', '‡¶ö‡¶æ‡¶ï‡ßÅ‡¶∞‡¶ø‡¶ú‡ßÄ‡¶¨‡¶ø', '‡¶¨‡ßç‡¶Ø‡¶¨‡¶∏‡¶æ‡¶Ø‡¶º‡ßÄ', '‡¶™‡¶•‡¶ö‡¶æ‡¶∞‡ßÄ'],
                    datasets: [{
                        data: getProfessionData(),
                        backgroundColor: [
                            '#FF6384',
                            '#36A2EB',
                            '#FFCE56',
                            '#4BC0C0',
                            '#9966FF',
                            '#FF9F40'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        },
                        title: {
                            display: true,
                            text: '‡¶™‡ßá‡¶∂‡¶æ‡¶≠‡¶ø‡¶§‡ßç‡¶§‡¶ø‡¶ï ‡¶¨‡¶ø‡¶§‡¶∞‡¶£'
                        }
                    }
                }
            });

            // Usage Reason Chart
            const ctx2 = document.getElementById('usageChart').getContext('2d');
            usageChart = new Chart(ctx2, {
                type: 'bar',
                data: {
                    labels: ['‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü/‡¶è‡¶Æ‡¶¨‡¶ø ‡¶ö‡ßá‡¶ï', '‡¶è‡¶° ‡¶¶‡ßá‡¶ñ‡¶æ', '‡¶â‡¶≠‡¶Ø‡¶º'],
                    datasets: [{
                        label: '‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ',
                        data: getUsageData(),
                        backgroundColor: [
                            'rgba(54, 162, 235, 0.8)',
                            'rgba(255, 99, 132, 0.8)',
                            'rgba(255, 206, 86, 0.8)'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        title: {
                            display: true,
                            text: 'MyGP ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡ßá‡¶∞ ‡¶ï‡¶æ‡¶∞‡¶£'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        }

        function getProfessionData() {
            const professions = ['‡¶°‡¶æ‡¶ï‡ßç‡¶§‡¶æ‡¶∞', '‡¶á‡¶û‡ßç‡¶ú‡¶ø‡¶®‡¶ø‡¶Ø‡¶º‡¶æ‡¶∞', '‡¶õ‡¶æ‡¶§‡ßç‡¶∞', '‡¶ö‡¶æ‡¶ï‡ßÅ‡¶∞‡¶ø‡¶ú‡ßÄ‡¶¨‡¶ø', '‡¶¨‡ßç‡¶Ø‡¶¨‡¶∏‡¶æ‡¶Ø‡¶º‡ßÄ', '‡¶™‡¶•‡¶ö‡¶æ‡¶∞‡ßÄ'];
            return professions.map(p => surveyData.filter(d => d.profession === p).length);
        }

        function getUsageData() {
            const mbCheckers = surveyData.filter(d => d.reason && d.reason.includes('‡¶è‡¶Æ‡¶¨‡¶ø')).length;
            const adViewers = surveyData.filter(d => d.reason && d.reason.includes('‡¶è‡¶°')).length;
            const both = surveyData.filter(d => d.reason === '‡¶â‡¶≠‡¶Ø‡¶º').length;
            return [mbCheckers - both, adViewers - both, both];
        }

        function updateCharts() {
            if (professionChart) {
                professionChart.data.datasets[0].data = getProfessionData();
                professionChart.update();
            }
            if (usageChart) {
                usageChart.data.datasets[0].data = getUsageData();
                usageChart.update();
            }
        }

        // Export Overall Report as Excel
        async function exportData() {
            if (surveyData.length === 0) {
                showToast('‡¶ï‡ßã‡¶® ‡¶°‡ßá‡¶ü‡¶æ ‡¶®‡ßá‡¶á', 'warning');
                return;
            }

            // Create workbook
            const wb = XLSX.utils.book_new();

            // Summary Statistics Sheet
            const professions = ['‡¶°‡¶æ‡¶ï‡ßç‡¶§‡¶æ‡¶∞', '‡¶á‡¶û‡ßç‡¶ú‡¶ø‡¶®‡¶ø‡¶Ø‡¶º‡¶æ‡¶∞', '‡¶õ‡¶æ‡¶§‡ßç‡¶∞', '‡¶ö‡¶æ‡¶ï‡ßÅ‡¶∞‡¶ø‡¶ú‡ßÄ‡¶¨‡¶ø', '‡¶¨‡ßç‡¶Ø‡¶¨‡¶∏‡¶æ‡¶Ø‡¶º‡ßÄ', '‡¶™‡¶•‡¶ö‡¶æ‡¶∞‡ßÄ'];
            
            const summaryData = [
                ['MyGP ‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡ßá ‡¶∏‡¶æ‡¶Æ‡¶ó‡ßç‡¶∞‡¶ø‡¶ï ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü', '', '', '', '', ''],
                ['‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ:', new Date().toLocaleDateString('bn-BD'), '', '', '', ''],
                ['‡¶Æ‡ßã‡¶ü ‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡ßá:', surveyData.length, '', '', '', ''],
                ['', '', '', '', '', ''],
                ['‡¶™‡ßá‡¶∂‡¶æ', '‡¶Æ‡ßã‡¶ü ‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡ßá', 'MyGP ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ', '‡¶è‡¶° ‡¶¶‡ßá‡¶ñ‡ßá‡¶®', '‡¶è‡¶Æ‡¶¨‡¶ø ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡ßá‡¶®', '‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡ßá‡¶∞ ‡¶π‡¶æ‡¶∞']
            ];

            professions.forEach(profession => {
                const profData = surveyData.filter(d => d.profession === profession);
                const total = profData.length;
                const myGPUsers = profData.filter(d => d.useMyGP === 'yes').length;
                const adViewers = profData.filter(d => d.reason && d.reason.includes('‡¶è‡¶°')).length;
                const mbCheckers = profData.filter(d => d.reason && d.reason.includes('‡¶è‡¶Æ‡¶¨‡¶ø')).length;
                const percentage = total > 0 ? Math.round((myGPUsers/total)*100) : 0;

                summaryData.push([
                    profession,
                    total,
                    myGPUsers,
                    adViewers,
                    mbCheckers,
                    `${percentage}%`
                ]);
            });

            // Add overall statistics
            const totalSurveyed = surveyData.length;
            const myGPUsers = surveyData.filter(d => d.useMyGP === 'yes').length;
            const adViewers = surveyData.filter(d => d.reason && d.reason.includes('‡¶è‡¶°')).length;
            const mbCheckers = surveyData.filter(d => d.reason && d.reason.includes('‡¶è‡¶Æ‡¶¨‡¶ø')).length;

            summaryData.push(['', '', '', '', '', '']);
            summaryData.push(['‡¶∏‡¶∞‡ßç‡¶¨‡¶Æ‡ßã‡¶ü', totalSurveyed, myGPUsers, adViewers, mbCheckers, `${totalSurveyed > 0 ? Math.round((myGPUsers/totalSurveyed)*100) : 0}%`]);

            const summarySheet = XLSX.utils.aoa_to_sheet(summaryData);

            // Set column widths
            summarySheet['!cols'] = [
                { wch: 20 },
                { wch: 15 },
                { wch: 20 },
                { wch: 15 },
                { wch: 20 },
                { wch: 15 }
            ];

            // All Data Sheet
            const allDataHeaders = [['‡¶ï‡ßç‡¶∞‡¶Æ‡¶ø‡¶ï', '‡¶®‡¶æ‡¶Æ', '‡¶´‡ßã‡¶® ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞', '‡¶™‡ßá‡¶∂‡¶æ', 'MyGP ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞', '‡¶ï‡¶æ‡¶∞‡¶£', '‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ']];
            
            const allData = surveyData.map((d, index) => [
                index + 1,
                d.name || '-',
                d.phoneNumber,
                d.profession,
                d.useMyGP === 'yes' ? '‡¶π‡ßç‡¶Ø‡¶æ‡¶Å' : '‡¶®‡¶æ',
                d.reason || '-',
                new Date(d.timestamp).toLocaleDateString('bn-BD')
            ]);

            const allDataSheet = XLSX.utils.aoa_to_sheet([...allDataHeaders, ...allData]);

            // Set column widths for all data
            allDataSheet['!cols'] = [
                { wch: 8 },
                { wch: 20 },
                { wch: 15 },
                { wch: 15 },
                { wch: 15 },
                { wch: 30 },
                { wch: 15 }
            ];

            // Individual profession sheets
            professions.forEach(profession => {
                const profData = surveyData.filter(d => d.profession === profession);
                
                if (profData.length > 0) {
                    const profHeaders = [['‡¶ï‡ßç‡¶∞‡¶Æ‡¶ø‡¶ï', '‡¶®‡¶æ‡¶Æ', '‡¶´‡ßã‡¶® ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞', 'MyGP ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞', '‡¶ï‡¶æ‡¶∞‡¶£', '‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ']];
                    const profRows = profData.map((d, index) => [
                        index + 1,
                        d.name || '-',
                        d.phoneNumber,
                        d.useMyGP === 'yes' ? '‡¶π‡ßç‡¶Ø‡¶æ‡¶Å' : '‡¶®‡¶æ',
                        d.reason || '-',
                        new Date(d.timestamp).toLocaleDateString('bn-BD')
                    ]);

                    const profSheet = XLSX.utils.aoa_to_sheet([...profHeaders, ...profRows]);
                    profSheet['!cols'] = [
                        { wch: 8 },
                        { wch: 20 },
                        { wch: 15 },
                        { wch: 15 },
                        { wch: 30 },
                        { wch: 15 }
                    ];

                    XLSX.utils.book_append_sheet(wb, profSheet, profession);
                }
            });

            // Add summary and all data sheets
            XLSX.utils.book_append_sheet(wb, summarySheet, '‡¶∏‡¶æ‡¶Æ‡¶ó‡ßç‡¶∞‡¶ø‡¶ï ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü');
            XLSX.utils.book_append_sheet(wb, allDataSheet, '‡¶∏‡¶ï‡¶≤ ‡¶°‡ßá‡¶ü‡¶æ');

            // Generate filename
            const filename = `MyGP_Survey_Overall_Report_${new Date().toISOString().split('T')[0]}.xlsx`;

            // Download
            XLSX.writeFile(wb, filename);
            
            showToast('‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!', 'success');
        }

        // Toast Notification
        function showToast(message, type = 'info') {
            const toast = document.createElement('div');
            toast.className = 'custom-toast';
            toast.innerHTML = `
                <div class="d-flex align-items-center">
                    <i class="bi ${type === 'success' ? 'bi-check-circle-fill text-success' : type === 'warning' ? 'bi-exclamation-triangle-fill text-warning' : type === 'error' ? 'bi-x-circle-fill text-danger' : 'bi-info-circle-fill text-info'} me-2"></i>
                    <span>${message}</span>
                </div>
            `;
            
            document.getElementById('toastContainer').appendChild(toast);
            
            setTimeout(() => {
                toast.style.animation = 'slideIn 0.3s ease reverse';
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        // Tab Change Animation
        document.querySelectorAll('[data-bs-toggle="tab"]').forEach(tab => {
            tab.addEventListener('shown.bs.tab', function() {
                if (this.id === 'dashboard-tab') {
                    updateCharts();
                }
            });
        });
    </script>
</body>
</html>